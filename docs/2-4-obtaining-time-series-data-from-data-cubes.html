<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="2.4 Obtaining time series data from data cubes | sits: Data Analysis and Machine Learning for Data Cubes using Satellite Image Time Series" />
<meta property="og:type" content="book" />

<meta property="og:image" content="images/cover.png" />
<meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The output format for this example is bookdown::gitbook.</p>" />



<meta name="date" content="2021-03-30" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The output format for this example is bookdown::gitbook.</p>">

<title>2.4 Obtaining time series data from data cubes | sits: Data Analysis and Machine Learning for Data Cubes using Satellite Image Time Series</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>
<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#preface">Preface</a></li>
<li class="has-sub"><a href="1-introduction.html#introduction"><span class="toc-section-number">1</span> Introduction</a><ul>
<li><a href="1-1-workflow.html#workflow"><span class="toc-section-number">1.1</span> Workflow</a></li>
<li class="has-sub"><a href="1-2-handling-data-cubes-in-sits.html#handling-data-cubes-in-sits"><span class="toc-section-number">1.2</span> Handling Data Cubes in <strong>sits</strong></a><ul>
<li><a href="1-2-handling-data-cubes-in-sits.html#image-data-cubes-as-the-basis-for-big-earth-observation-data-analysis"><span class="toc-section-number">1.2.1</span> Image data cubes as the basis for big Earth observation data analysis</a></li>
<li><a href="1-2-handling-data-cubes-in-sits.html#using-stac-to-access-image-data-cubes"><span class="toc-section-number">1.2.2</span> Using STAC to Access Image Data Cubes</a></li>
<li><a href="1-2-handling-data-cubes-in-sits.html#defining-a-data-cube-using-files"><span class="toc-section-number">1.2.3</span> Defining a data cube using files</a></li>
</ul></li>
<li class="has-sub"><a href="1-3-handling-satellite-image-time-series-in-sits.html#handling-satellite-image-time-series-in-sits"><span class="toc-section-number">1.3</span> Handling satellite image time series in <strong>sits</strong></a><ul>
<li><a href="1-3-handling-satellite-image-time-series-in-sits.html#data-structure"><span class="toc-section-number">1.3.1</span> Data structure</a></li>
<li><a href="1-3-handling-satellite-image-time-series-in-sits.html#obtaining-time-series-data"><span class="toc-section-number">1.3.2</span> Obtaining time series data</a></li>
</ul></li>
<li><a href="1-4-filtering-techniques.html#filtering-techniques"><span class="toc-section-number">1.4</span> Filtering techniques</a></li>
<li><a href="1-5-clustering-for-sample-quality-control-using-self-organizing-maps.html#clustering-for-sample-quality-control-using-self-organizing-maps"><span class="toc-section-number">1.5</span> Clustering for sample quality control using self-organizing maps</a></li>
<li><a href="1-6-classification-using-machine-learning.html#classification-using-machine-learning"><span class="toc-section-number">1.6</span> Classification using machine learning</a></li>
<li><a href="1-7-validation-techniques.html#validation-techniques"><span class="toc-section-number">1.7</span> Validation techniques</a></li>
<li class="has-sub"><a href="1-8-cube-classification.html#cube-classification"><span class="toc-section-number">1.8</span> Cube classification</a><ul>
<li><a href="1-8-cube-classification.html#steps-for-cube-classification"><span class="toc-section-number">1.8.1</span> Steps for cube classification</a></li>
<li><a href="1-8-cube-classification.html#adjustments-for-improved-performance"><span class="toc-section-number">1.8.2</span> Adjustments for improved performance</a></li>
</ul></li>
<li><a href="1-9-smoothing-and-labelling-of-raster-data-after-classification.html#smoothing-and-labelling-of-raster-data-after-classification"><span class="toc-section-number">1.9</span> Smoothing and Labelling of raster data after classification</a></li>
<li><a href="1-10-final-remarks.html#final-remarks"><span class="toc-section-number">1.10</span> Final remarks</a></li>
<li><a href="1-11-acknowledgements.html#acknowledgements"><span class="toc-section-number">1.11</span> Acknowledgements</a></li>
</ul></li>
<li class="has-sub"><a href="2-acessing-time-series-information-in-sits.html#acessing-time-series-information-in-sits"><span class="toc-section-number">2</span> Acessing time series information in SITS</a><ul>
<li><a href="2-1-data-structures-for-satellite-time-series.html#data-structures-for-satellite-time-series"><span class="toc-section-number">2.1</span> Data structures for satellite time series</a></li>
<li><a href="2-2-utilities-for-handling-time-series.html#utilities-for-handling-time-series"><span class="toc-section-number">2.2</span> Utilities for handling time series</a></li>
<li><a href="2-3-time-series-visualisation.html#time-series-visualisation"><span class="toc-section-number">2.3</span> Time series visualisation</a></li>
<li><a href="2-4-obtaining-time-series-data-from-data-cubes.html#obtaining-time-series-data-from-data-cubes"><span class="toc-section-number">2.4</span> Obtaining time series data from data cubes</a></li>
</ul></li>
<li class="has-sub"><a href="3-satellite-image-time-series-filtering-with-sits.html#satellite-image-time-series-filtering-with-sits"><span class="toc-section-number">3</span> Satellite Image Time Series Filtering with SITS</a><ul>
<li><a href="3-1-filtering-techniques-in-sits.html#filtering-techniques-in-sits"><span class="toc-section-number">3.1</span> Filtering techniques in SITS</a></li>
<li class="has-sub"><a href="3-2-common-interface-to-sits-filter-functions.html#common-interface-to-sits-filter-functions"><span class="toc-section-number">3.2</span> Common interface to SITS filter functions</a><ul>
<li><a href="3-2-common-interface-to-sits-filter-functions.html#savitzkygolay-filter"><span class="toc-section-number">3.2.1</span> Savitzky–Golay filter</a></li>
<li><a href="3-2-common-interface-to-sits-filter-functions.html#whittaker-filter"><span class="toc-section-number">3.2.2</span> Whittaker filter</a></li>
<li><a href="3-2-common-interface-to-sits-filter-functions.html#envelope-filter"><span class="toc-section-number">3.2.3</span> Envelope filter</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="4-time-series-clustering-to-improve-the-quality-of-training-samples.html#time-series-clustering-to-improve-the-quality-of-training-samples"><span class="toc-section-number">4</span> Time Series Clustering to Improve the Quality of Training Samples</a><ul>
<li><a href="4-1-clustering-for-sample-quality-control.html#clustering-for-sample-quality-control"><span class="toc-section-number">4.1</span> Clustering for sample quality control</a></li>
<li class="has-sub"><a href="4-2-hierachical-clustering-for-sample-quality-control.html#hierachical-clustering-for-sample-quality-control"><span class="toc-section-number">4.2</span> Hierachical clustering for Sample Quality Control</a><ul>
<li><a href="4-2-hierachical-clustering-for-sample-quality-control.html#creating-a-dendogram"><span class="toc-section-number">4.2.1</span> Creating a dendogram</a></li>
<li><a href="4-2-hierachical-clustering-for-sample-quality-control.html#using-a-dendrogram-to-evaluate-sample-quality"><span class="toc-section-number">4.2.2</span> Using a dendrogram to evaluate sample quality</a></li>
</ul></li>
<li class="has-sub"><a href="4-3-using-self-organizing-maps-for-sample-quality.html#using-self-organizing-maps-for-sample-quality"><span class="toc-section-number">4.3</span> Using Self-organizing Maps for Sample Quality</a><ul>
<li><a href="4-3-using-self-organizing-maps-for-sample-quality.html#introduction-to-self-organizing-maps"><span class="toc-section-number">4.3.1</span> Introduction to Self-organizing Maps</a></li>
<li><a href="4-3-using-self-organizing-maps-for-sample-quality.html#using-som-for-removing-class-noise"><span class="toc-section-number">4.3.2</span> Using SOM for removing class noise</a></li>
<li><a href="4-3-using-self-organizing-maps-for-sample-quality.html#comparing-global-accuracy-of-original-and-clean-samples"><span class="toc-section-number">4.3.3</span> Comparing Global Accuracy of Original and Clean Samples</a></li>
</ul></li>
<li><a href="4-4-conclusion.html#conclusion"><span class="toc-section-number">4.4</span> Conclusion</a></li>
</ul></li>
<li class="has-sub"><a href="5-machine-learning-for-data-cubes-using-the-sits-package.html#machine-learning-for-data-cubes-using-the-sits-package"><span class="toc-section-number">5</span> Machine Learning for Data Cubes using the SITS package</a><ul>
<li><a href="5-1-machine-learning-classification.html#machine-learning-classification"><span class="toc-section-number">5.1</span> Machine learning classification</a></li>
<li><a href="5-2-data-used-in-the-machine-learning-examples.html#data-used-in-the-machine-learning-examples"><span class="toc-section-number">5.2</span> Data used in the machine learning examples</a></li>
<li><a href="5-3-visualizing-samples.html#visualizing-samples"><span class="toc-section-number">5.3</span> Visualizing Samples</a></li>
<li><a href="5-4-common-interface-to-machine-learning-and-deeplearning-models.html#common-interface-to-machine-learning-and-deeplearning-models"><span class="toc-section-number">5.4</span> Common interface to machine learning and deeplearning models</a></li>
<li><a href="5-5-random-forests.html#random-forests"><span class="toc-section-number">5.5</span> Random forests</a></li>
<li><a href="5-6-support-vector-machines.html#support-vector-machines"><span class="toc-section-number">5.6</span> Support Vector Machines</a></li>
<li><a href="5-7-extreme-gradient-boosting.html#extreme-gradient-boosting"><span class="toc-section-number">5.7</span> Extreme Gradient Boosting</a></li>
<li><a href="5-8-deep-learning-using-multi-layer-perceptrons.html#deep-learning-using-multi-layer-perceptrons"><span class="toc-section-number">5.8</span> Deep learning using multi-layer perceptrons</a></li>
<li><a href="5-9-d-convolutional-neural-networks.html#d-convolutional-neural-networks"><span class="toc-section-number">5.9</span> 1D Convolutional Neural Networks</a></li>
<li><a href="5-10-residual-1d-cnn-networks-resnet.html#residual-1d-cnn-networks-resnet"><span class="toc-section-number">5.10</span> Residual 1D CNN Networks (ResNet)</a></li>
</ul></li>
<li class="has-sub"><a href="6-classification-of-images-in-data-cubes-using-satellite-image-time-series.html#classification-of-images-in-data-cubes-using-satellite-image-time-series"><span class="toc-section-number">6</span> Classification of Images in Data Cubes using Satellite Image Time Series</a><ul>
<li><a href="6-1-image-data-cubes-as-the-basis-for-big-earth-observation-data-analysis-1.html#image-data-cubes-as-the-basis-for-big-earth-observation-data-analysis-1"><span class="toc-section-number">6.1</span> Image data cubes as the basis for big Earth observation data analysis</a></li>
<li><a href="6-2-defining-a-data-cube-using-files-organised-as-raster-bricks.html#defining-a-data-cube-using-files-organised-as-raster-bricks"><span class="toc-section-number">6.2</span> Defining a data cube using files organised as raster bricks</a></li>
<li><a href="6-3-classification-using-machine-learning-1.html#classification-using-machine-learning-1"><span class="toc-section-number">6.3</span> Classification using machine learning</a></li>
<li class="has-sub"><a href="6-4-cube-classification-1.html#cube-classification-1"><span class="toc-section-number">6.4</span> Cube classification</a><ul>
<li><a href="6-4-cube-classification-1.html#steps-for-cube-classification-1"><span class="toc-section-number">6.4.1</span> Steps for cube classification</a></li>
<li><a href="6-4-cube-classification-1.html#adjustments-for-improved-performance-1"><span class="toc-section-number">6.4.2</span> Adjustments for improved performance</a></li>
</ul></li>
<li><a href="6-5-final-remarks-1.html#final-remarks-1"><span class="toc-section-number">6.5</span> Final remarks</a></li>
</ul></li>
<li class="has-sub"><a href="7-post-classification-smoothing-using-bayesian-techniques-in-sits.html#post-classification-smoothing-using-bayesian-techniques-in-sits"><span class="toc-section-number">7</span> Post classification smoothing using Bayesian techniques in SITS</a><ul>
<li><a href="7-1-introduction-1.html#introduction-1"><span class="toc-section-number">7.1</span> Introduction</a></li>
<li class="has-sub"><a href="7-2-overview-of-bayesian-estimattion.html#overview-of-bayesian-estimattion"><span class="toc-section-number">7.2</span> Overview of Bayesian estimattion</a><ul>
<li><a href="7-2-overview-of-bayesian-estimattion.html#smmothing-using-bayes-rule"><span class="toc-section-number">7.2.1</span> Smmothing using Bayes’ rule</a></li>
</ul></li>
<li><a href="7-3-use-of-bayesian-smoothing-in-sits.html#use-of-bayesian-smoothing-in-sits"><span class="toc-section-number">7.3</span> Use of Bayesian smoothing in SITS</a></li>
</ul></li>
<li class="has-sub"><a href="8-validation-and-accuracy-measurements-in-sits.html#validation-and-accuracy-measurements-in-sits"><span class="toc-section-number">8</span> Validation and accuracy measurements in SITS</a><ul>
<li><a href="8-1-validation-techniques-1.html#validation-techniques-1"><span class="toc-section-number">8.1</span> Validation techniques</a></li>
<li><a href="8-2-comparing-different-validation-methods.html#comparing-different-validation-methods"><span class="toc-section-number">8.2</span> Comparing different validation methods</a></li>
</ul></li>
<li><a href="references.html#references">References</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="obtaining-time-series-data-from-data-cubes" class="section level2">
<h2><span class="header-section-number">2.4</span> Obtaining time series data from data cubes</h2>
<p>To get a time series in SITS, one has to create a data cube first, as described above. Users can request one or more time series points from a data cube by using <code>sits_get_data()</code>. This function provides a general means of access to image time series. Given a data cube, the user provides the latitude and longitude of the desired location, the bands, and the start date and end date of the time series. If the start and end dates are not provided, it retrieves all the available period. The result is a tibble that can be visualized using <code>plot()</code>.</p>
<p>The SITS package enables uses to create data cube based on files. In this case, these files should be organized as <code>raster stacks</code>. A raster stack is a single-layer raster object. Each file refer to one time instance and one spectral band. To allow users to create data cubes based on files, SITS needs to know the names of satellite and sensor, and the names of the directory that contains the files.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb30-1"></a><span class="co"># Obtain a raster cube with 23 instances for one year</span></span>
<span id="cb30-2"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb30-2"></a><span class="co"># Select the band &quot;ndvi&quot;, &quot;evi&quot; from images available in the &quot;sitsdata&quot; package</span></span>
<span id="cb30-3"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb30-3"></a>data_dir &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata/sinop&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;sitsdata&quot;</span>)</span>
<span id="cb30-4"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb30-4"></a></span>
<span id="cb30-5"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb30-5"></a><span class="co"># create a raster metadata file based on the information about the files</span></span>
<span id="cb30-6"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb30-6"></a>raster_cube &lt;-<span class="st"> </span><span class="kw">sits_cube</span>(</span>
<span id="cb30-7"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb30-7"></a>    <span class="dt">source     =</span> <span class="st">&quot;LOCAL&quot;</span>,</span>
<span id="cb30-8"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb30-8"></a>    <span class="dt">satellite  =</span> <span class="st">&quot;TERRA&quot;</span>,</span>
<span id="cb30-9"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb30-9"></a>    <span class="dt">sensor     =</span> <span class="st">&quot;MODIS&quot;</span>,</span>
<span id="cb30-10"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb30-10"></a>    <span class="dt">name       =</span> <span class="st">&quot;Sinop&quot;</span>,</span>
<span id="cb30-11"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb30-11"></a>    <span class="dt">data_dir   =</span> data_dir,</span>
<span id="cb30-12"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb30-12"></a>    <span class="dt">parse_info =</span> <span class="kw">c</span>(<span class="st">&quot;X1&quot;</span>, <span class="st">&quot;X2&quot;</span>, <span class="st">&quot;band&quot;</span>, <span class="st">&quot;date&quot;</span>),</span>
<span id="cb30-13"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb30-13"></a>)</span>
<span id="cb30-14"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb30-14"></a></span>
<span id="cb30-15"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb30-15"></a><span class="co"># a point in the transition forest to pasture in Northern MT</span></span>
<span id="cb30-16"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb30-16"></a><span class="co"># obtain a time series from the raster cube for this point</span></span>
<span id="cb30-17"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb30-17"></a>series.tb &lt;-<span class="st"> </span><span class="kw">sits_get_data</span>(<span class="dt">cube      =</span> raster_cube,</span>
<span id="cb30-18"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb30-18"></a>                           <span class="dt">longitude =</span> <span class="fl">-55.57320</span>, </span>
<span id="cb30-19"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb30-19"></a>                           <span class="dt">latitude  =</span> <span class="fl">-11.50566</span>,</span>
<span id="cb30-20"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb30-20"></a>                           <span class="dt">bands     =</span> <span class="kw">c</span>(<span class="st">&quot;NDVI&quot;</span>, <span class="st">&quot;EVI&quot;</span>))</span>
<span id="cb30-21"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb30-21"></a><span class="kw">plot</span>(series.tb)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-21"></span>
<img src="sitsbook_files/figure-html/unnamed-chunk-21-1.png" alt="NDVI and EVI time series fetched from local raster cube." width="70%" />
<p class="caption">
Figure 2.3: NDVI and EVI time series fetched from local raster cube.
</p>
</div>
<p>A useful case is when a set of labelled samples are available to be used as a training data set. In this case, one usually has trusted observations which are labelled and commonly stored in plain text CSV files. Function <code>sits_get_data()</code> can get a CSV file path as an argument. The CSV file must provide, for each time series, its latitude and longitude, the start and end dates, and a label associated to a ground sample. An example of a CSV file used is shown below:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb31-1"></a><span class="co"># retrieve a list of samples described by a CSV file</span></span>
<span id="cb31-2"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb31-2"></a>samples.csv &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata/samples/samples_sinop_crop.csv&quot;</span>,</span>
<span id="cb31-3"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb31-3"></a>                           <span class="dt">package =</span> <span class="st">&quot;sits&quot;</span>)</span>
<span id="cb31-4"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb31-4"></a><span class="co"># get the points from a data cube in raster brick format</span></span>
<span id="cb31-5"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb31-5"></a>points &lt;-<span class="st"> </span><span class="kw">sits_get_data</span>(raster_cube, <span class="dt">file =</span> samples.csv)</span></code></pre></div>
<pre><code>#&gt; All points have been retrieved</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb33-1"></a><span class="co"># show the tibble with the points</span></span>
<span id="cb33-2"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb33-2"></a>points</span></code></pre></div>
<pre><code>#&gt; # A tibble: 12 x 7
#&gt;    longitude latitude start_date end_date   label    cube  time_series      
#&gt;        &lt;dbl&gt;    &lt;dbl&gt; &lt;date&gt;     &lt;date&gt;     &lt;chr&gt;    &lt;chr&gt; &lt;list&gt;           
#&gt;  1     -55.7    -11.8 2013-09-14 2014-08-29 Pasture  Sinop &lt;tibble [23 × 3]&gt;
#&gt;  2     -55.6    -11.8 2013-09-14 2014-08-29 Pasture  Sinop &lt;tibble [23 × 3]&gt;
#&gt;  3     -55.7    -11.8 2013-09-14 2014-08-29 Forest   Sinop &lt;tibble [23 × 3]&gt;
#&gt;  4     -55.6    -11.8 2013-09-14 2014-08-29 Pasture  Sinop &lt;tibble [23 × 3]&gt;
#&gt;  5     -55.7    -11.8 2013-09-14 2014-08-29 Forest   Sinop &lt;tibble [23 × 3]&gt;
#&gt;  6     -55.6    -11.7 2013-09-14 2014-08-29 Forest   Sinop &lt;tibble [23 × 3]&gt;
#&gt;  7     -55.7    -11.7 2013-09-14 2014-08-29 Soy_Corn Sinop &lt;tibble [23 × 3]&gt;
#&gt;  8     -55.7    -11.7 2013-09-14 2014-08-29 Soy_Corn Sinop &lt;tibble [23 × 3]&gt;
#&gt;  9     -55.7    -11.7 2013-09-14 2014-08-29 Soy_Corn Sinop &lt;tibble [23 × 3]&gt;
#&gt; 10     -55.6    -11.8 2013-09-14 2014-08-29 Soy_Corn Sinop &lt;tibble [23 × 3]&gt;
#&gt; 11     -55.6    -11.8 2013-09-14 2014-08-29 Soy_Corn Sinop &lt;tibble [23 × 3]&gt;
#&gt; 12     -55.6    -11.8 2013-09-14 2014-08-29 Soy_Corn Sinop &lt;tibble [23 × 3]&gt;</code></pre>
<p>A common situation is when users have samples available as shapefiles in point format. Since shapefiles contain only geometries, we need to provide information about the start and end times for which each label is valid. in this case, one should use the function <code>sits_get_data()</code> to retrieve data from a data cube based on the contents of the shapefile. The parameter <code>shp_attr</code> (optional) indicates the name of the column on the shapefile which contains the label to be associated to each time series; the parameter <code>.n_shp_pol</code> (defaults to 20) determines the number of samples to be extracted from each polygon.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb35-1"></a><span class="co"># define the input shapefile (consisting of POLYGONS)</span></span>
<span id="cb35-2"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb35-2"></a>shp_file &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata/shapefiles/agriculture/parcel_agriculture.shp&quot;</span>, </span>
<span id="cb35-3"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb35-3"></a>                        <span class="dt">package =</span> <span class="st">&quot;sits&quot;</span>)</span>
<span id="cb35-4"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb35-4"></a></span>
<span id="cb35-5"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb35-5"></a><span class="co"># set the start and end dates </span></span>
<span id="cb35-6"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb35-6"></a>start_date &lt;-<span class="st"> &quot;2013-09-14&quot;</span></span>
<span id="cb35-7"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb35-7"></a>end_date   &lt;-<span class="st"> &quot;2014-08-29&quot;</span></span>
<span id="cb35-8"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb35-8"></a></span>
<span id="cb35-9"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb35-9"></a><span class="co"># define the name of attribute of the shapefile that contains the label</span></span>
<span id="cb35-10"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb35-10"></a>shp_attr &lt;-<span class="st"> &quot;ext_na&quot;</span></span>
<span id="cb35-11"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb35-11"></a></span>
<span id="cb35-12"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb35-12"></a><span class="co"># define the number of samples to extract from each polygon</span></span>
<span id="cb35-13"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb35-13"></a>.n_shp_pol &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb35-14"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb35-14"></a></span>
<span id="cb35-15"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb35-15"></a><span class="co"># read the points in the shapefile and produce a CSV file</span></span>
<span id="cb35-16"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb35-16"></a>data &lt;-<span class="st"> </span><span class="kw">sits_get_data</span>(<span class="dt">cube       =</span> raster_cube, </span>
<span id="cb35-17"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb35-17"></a>                      <span class="dt">file       =</span> shp_file, </span>
<span id="cb35-18"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb35-18"></a>                      <span class="dt">start_date =</span> start_date, </span>
<span id="cb35-19"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb35-19"></a>                      <span class="dt">end_date   =</span> end_date, </span>
<span id="cb35-20"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb35-20"></a>                      <span class="dt">shp_attr   =</span> shp_attr, </span>
<span id="cb35-21"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb35-21"></a>                      <span class="dt">.n_shp_pol =</span> .n_shp_pol)</span>
<span id="cb35-22"><a href="2-4-obtaining-time-series-data-from-data-cubes.html#cb35-22"></a>data</span></code></pre></div>
<pre><code>#&gt; # A tibble: 0 x 0</code></pre>

</div>
<!-- </div> -->
<p style="text-align: center;">
<a href="2-3-time-series-visualisation.html"><button class="btn btn-default">Previous</button></a>
<a href="3-satellite-image-time-series-filtering-with-sits.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
